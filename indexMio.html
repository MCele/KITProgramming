<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title> Programación Tangible </title>
  <meta name="description" content="Hello, World! - A-Frame">

  <!-- import the webpage's stylesheet -->
  <link rel="stylesheet" href="style.css" />

  <!-- import the webpage's javascript file -->
  <!-- <script type="text/javascript" src="./node_modules/file-system/file-system.js"></script> -->
  <script type="text/javascript" src="./lib/move2.js"></script>
  <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
  <!--script src="home/celeste/Escritorio/tesis/Aframe/AR.js/aframe/build/aframe-ar.js"></script-->
  <!--script src="https://cdn.rawgit.com/jeromeetienne/AR.js/1.6.0/aframe/build/aframe-ar.js"></script-->
  <script src="https://rawgit.com/donmccurdy/aframe-extras/master/dist/aframe-extras.loaders.min.js"></script>

  <script>
    window.addEventListener('camera-init', (data) => {
      console.log('camera-init', data);
    })
    window.addEventListener('camera-error', (error) => {
      console.log('camera-error', error);
    })
    AFRAME.registerComponent('registerevents', {
      init: function () {
        var marker = this.el;
        //THREE.Object3D._threexDomEvent.camera(camera);
        //   console.log('marker: ', marker);
        marker.addEventListener('markerFound', function () { // marcador encontrado
          var markerId = marker.id;
          console.log('Marcador encontrado', markerId);
          // TODO: Add your own code here to react to the marker being found.
          // Marcador genera movimiento(JSON)
          generarMovimiento(markerId);
        });
        marker.addEventListener('markerLost', function () {
          var markerId = marker.id;
          console.log('marcador perdido', markerId);
          // TODO: Add your own code here to react to the marker being lost.
          // marcador que dejó de ser capturarado
        });
      }
    });
  </script>
</head>

<body style='margin : 0px; overflow: hidden;'>

  <a-scene embedded artoolkit='sourceType:webcam;'>
    <a-text id="presentacionText" value="Escanee los marcadores" align="center" color="#FFF" visible="true"
            position="0 -0.55 0.55" geometry="primitive: plane; width: 1.75" material="color: #333">
    </a-text>
    <a-marker url="./assets/patrones/pattern_flecha_abajo.patt" type="pattern" id='marker_abajo' registerevents>
      <!-- crear escena -->
      <!-- <a-scene embedded arjs="sourceType: webcam;"> -->
      <a-entity gltf-model='./assets/ply/scene.gltf' scale="2 2 2" position="0.1 -1 1.5" rotation="-90 -45 45"
                crossOrigin="anonymous" animation-mixer="clip:caminar_con_algo;" repeat="indefinite">
      </a-entity>
      <!-- </a-scene> -->
    </a-marker>
    <a-marker url="./assets/patrones/pattern_flecha_arriba.patt" type="pattern" id='marker_arriba' registerevents>
      <!-- crear escena -->
      <!-- <a-scene embedded arjs="sourceType: webcam;"> -->
      <a-entity gltf-model='./assets/ply/scene.gltf' scale="2 2 2" position="0.1 -1 -0.5" rotation="95 -120 45"
                crossOrigin="anonymous" animation-mixer="clip:caminar_con_algo;">
      </a-entity>

      <!-- </a-scene> -->
    </a-marker>
    <a-marker url="./assets/patrones/pattern_flecha_atras.patt" type="pattern" id='marker_atras' registerevents>
      <!-- crear escena -->
      <!-- <a-scene embedded arjs="sourceType: webcam;"> -->
      <a-entity gltf-model='./assets/ply/scene.gltf' scale="2 2 2" position="0.1 -1 1" rotation="25 -90 45"
                crossOrigin="anonymous" animation-mixer="clip:caminar_con_algo;" repeat="indefinite">
      </a-entity>
      <!-- </a-scene> -->
    </a-marker>
    <a-marker url="./assets/patrones/pattern_flecha_adelante.patt" type="pattern" id='marker_adelante' registerevents>
      <!-- crear escena -->
      <!-- <a-scene embedded arjs="sourceType: webcam;"> -->
      <a-entity gltf-model='./assets/ply/scene.gltf' scale="2 2 2" position="0.1 -1 1" rotation="25 90 -45"
                crossOrigin="anonymous" animation-mixer="clip:caminar_con_algo;">
      </a-entity>

      <!-- </a-scene> -->
    </a-marker>
    <div>
      <!-- <a-scene embedded arjs="sourceType: webcam;"> -->
      <a-assets>
        <img id="abajo" src="./assets/patrones/pattern-flecha_arriba.png" crossOrigin="anonymous">
      </a-assets>
      <a-image src="#abajo" scale="5 5 5" position="0.1 1 1.5" width="3" height="1.5" transparent="false"
               visible="true">
      </a-image>
      <!-- </a-scene> -->
    </div>

    <!-- add a simple camera -->
    <a-entity camera></a-entity>
    <!--/a-marker-camera-->
  </a-scene>
</body>

</html>




<!--a-box material="opacity: 0.3"; color="tomato" depth="1" height="1" width="1">
        <a-animation attribute="rotation" dur="3000" to="0 360 0" repeat="indefinite" > </a-animation>   
        <a-animation attribute="material.color" from="blue" to="red" dur="3000" repeat="indefinite"></a-animation>
      </a-box> <!-a-box position="0 0.5 0" material="opacity: 0.5;" color="yellow"> </a-box-->


<!--a-entity>
      <a-entity id="drone" position="0 0 -0.5" scale="0.5 0.5 0.5" rotation="-90 -45 45"
        gltf-model-next="src: url(./assets/ply/scene.gltf);"
        animation-mixer>
      </a-entity-->
<!--a-animation attribute="alternate"                   
                   fill="backwards"
                   to="0 0 0.5"
                   repeat="indefinite"
                   direction="alternateReverse"
                   begin="1000"
                   dur="10000">        
      </a-animation>
      </a-entity-->


<!-- VERSION SOFA -->
<!--a-entity>
        <a-entity position="0 0 -0.5" scale="0.05 0.05 0.05" rotation="-90 -45 45"
          gltf-model-next="src: url(https://murugandurai.github.io/zhopout-puthithagapguthal-ar/assets/aj_bellydancing/scene.gltf);"
          animation-mixer>
        </a-entity>          
        <a-animation attribute="alternate"                   
                     fill="backwards"
                     to="0 0 0.5"
                     repeat="indefinite"
                     direction="alternateReverse"
                     begin="1000"
                     dur="10000">        
        </a-animation>
        </a-entity>
         <a-entity scale="0.2 0.2 0.2"
              obj-model="obj: url(https://rishavjayswal.github.io/augmented-reality/resources/couch.obj); 
              mtl: url(https://rishavjayswal.github.io/augmented-reality/resources/couch.mtl)">
          </a-entity-->